<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.mapper-seeker">

<select id="getProjectList" resultType="com.lx.odw.vo.ProjectVO">
	select 
		project_number,
		project_name,
		offer_id,
		project_start_date,
		project_end_date,
		ST_X(project_location) as project_lng,
		ST_Y(project_location) as project_lat,
		project_comment,
		project_subject,
		project_enroll_date,
		work_start_time,
		work_end_time
	from
		project
		
</select>

<select id="requestProjectJobListByProjectNumber" parameterType="com.lx.odw.vo.ProjectVO" resultType="com.lx.odw.vo.JobVO">
	select
		job_number,
		project_number,
		job_pay,
		job_name,
		job_start_date,
		job_end_date,
		job_requirement,
		job_limit_count
	from
		job
	where
		project_number = #{projectNumber}
		
</select>

<select id="requestProjectDetail" parameterType="com.lx.odw.vo.ProjectVO" resultType="com.lx.odw.vo.ProjectVO">
	select 
		project_number,
		project_name,
		offer_id,
		project_start_date,
		project_end_date,
		ST_X(project_location) as project_lng,
		ST_Y(project_location) as project_lat,
		project_comment,
		project_subject,
		project_enroll_date,
		work_start_time,
		work_end_time
	from
		project
	where
		project_number = #{projectNumber}
</select>

<select id="requestJobDetail" parameterType="com.lx.odw.vo.JobVO" resultType="com.lx.odw.vo.JobVO">
	select
		job_number,
		project_number,
		job_pay,
		job_name,
		job_start_date,
		job_end_date,
		job_requirement,
		job_limit_count
	from
		job
	where
		job_number = #{jobNumber}
</select>
<select id="requestTargetDateCount" parameterType="com.lx.odw.vo.JobCandidateVO" resultType="int">
	select
		count(*)
	from
		job_candidate
	where
		candidate_status = 1 and
		job_number = #{jobNumber} and
		target_date = Date(#{targetDate})
</select>

<select id="checkAnotherAccepted" parameterType="com.lx.odw.vo.JobCandidateVO" resultType="int">
	select
		count(*)
	from
		job_candidate
	where
		candidate_status = 1 and
		seeker_id = #{seekerId} and
		target_date = Date(#{targetDate})
</select>

<select id="checkDuplicateCandidate" parameterType="com.lx.odw.vo.JobCandidateVO" resultType="int">
	select
		count(*)
	from
		job_candidate
	where
		seeker_id = #{seekerId} and
		job_number = #{jobNumber} and
		target_date = Date(#{targetDate})
</select>

<select id="checkDuplicateAcceptCandidate" parameterType="com.lx.odw.vo.JobCandidateVO" resultType="int">
	select
		count(*)
	from
		job_candidate
	where
		seeker_id = #{seekerId} and
		job_number = #{jobNumber} and
		candidate_status = 1 and
		target_date = Date(#{targetDate})
</select>
<insert id="candidateJob" parameterType="com.lx.odw.vo.JobCandidateVO">
	insert
		into 
			job_candidate
			(seeker_id,job_number,target_date,candidate_status)
		values	
			(#{seekerId},#{jobNumber},#{targetDate},#{candidateStatus})
</insert>
<!-- <select id="ManageJobList" resultType="com.lx.odw.vo.JobVO"> -->
	<!-- select * --> 
	<!-- from  job --> 
	<!-- 윤정민 진행중.... join 해야함 -->
<!-- </select>--> 
</mapper>